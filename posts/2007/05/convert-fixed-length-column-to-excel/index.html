<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='https://fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <title>
                Convert fixed length column to Excel | metaodi
    </title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stefan Oderbolz (&quot;Odi&quot;)">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- load static files from bower -->
    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="/bower_components/jquery/dist/jquery.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Le styles -->
<link href='/assets/stylesheets/style.css' type='text/css' rel='stylesheet' media='all'>    
    <!-- Le scripts -->

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/posts/rss.xml" />

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

  -->
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">metaodi</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            
              <li><a href="/talks">Talks/Workshops</a></li>
            
            
              <li><a href="/tags">Tags</a></li>
            
            
              <li><a href="/archive">Archive</a></li>
            
            
              <li><a href="/about">About me</a></li>
            
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
    </nav>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>Convert fixed length column to Excel </h1>
</div>

<div class="row-fluid post-full">
  <div class="col-md-12">
    <div class="date">
      <span>14.05.2007</strong>
    </div>
    <div class="content">
      <p>I had to convert the output from sqlplus to an excel sheet. The problem
was, that I had no influence on the creation, so I could spool the file
directly to excel.</p>

<p>All I got were spool files like that:</p>

<pre><code>      CLASS_ID SUPER_CLASS_ID   COUNT(*)
============== ============== ==========
       128           8765         18
       128           8765        131
       128           8765          7
</code></pre>

<p>My idea was to take the line used to seperate the column titles and the
data as the data that gives me the length of each column (refered as the
column line in my function below). Then just simply extract a block from
start to end (as given) based on the gathered column length information.</p>

<p>Maybe someone can use this piece of VBA code:</p>

<pre><code>Public Sub convertFixed()
    Dim sFile As String
    Dim iCount As Long
    Dim iSubCount As Long
    Dim iLastCount As Long
    Dim i As Integer
    Dim Length() As Integer
    Dim sValue As String

    Dim iStart As Integer
    Dim iEnd As Integer
    Dim iColumn As Integer


    &#39;&#39;clear previous data
    Cells.ClearContents

    &#39;&#39;choose the file with the windows file dialog
    With Application.FileDialog(msoFileDialogFilePicker)
    .AllowMultiSelect = False
    .Title = &quot;Choose log file to convert&quot;
    .InitialFileName = ThisWorkbook.Path
    .InitialView = msoFileDialogViewDetails
    .Filters.Clear

    &#39;&#39;the filter is set to .log .spool and .txt files
    .Filters.Add &quot;Log file&quot;, &quot;*.log, *.spool, *.txt&quot;

    .ButtonName = &quot;Load&quot;
    If .Show = -1 Then
        sFile = .SelectedItems(1)
    Else
        &#39;&#39;stop execution if no file is selected
        Exit Sub
    End If
    End With


    &#39;&#39;we need the following informtion (gather with InputBoxes)
    &#39;&#39;line to scan the column lengh (space delimiteted) -&gt; line number
    &#39;&#39;begin of block (line number)
    &#39;&#39;end of block (line number)
    iStart = InputBox(&quot;Enter line number where block starts:&quot;, &quot;Line number of Start&quot;)
    iEnd = InputBox(&quot;Enter line number where block ends:&quot;, &quot;Line number of End&quot;)
    iColumn = InputBox(&quot;Enter line number of fixed length specification&quot;, &quot;Line number for fixed length&quot;)

    &#39;&#39;the first loop is to get the correct column length
    &#39;open the file
    Open sFile For Input Access Read As #1
    iCount = 1
    &#39;&#39;loop until end of file (EOF) is reached
    Do Until EOF(1)
    Line Input #1, sLine
    If (iCount = iColumn) Then
        &#39;&#39;exit if the column line (to scan the length) is reached
        Exit Do
    End If
    iCount = iCount + 1
    Loop
    &#39;&#39;close the file
    Close #1

    iCount = 0
    iSubCount = 1
    iLastCount = 0
    &#39;&#39;sLine now contains a line that gives us the fixed length of the columns
    sLine = RTrim(sLine)
    Do Until iSubCount &gt; Len(sLine)
    If (Mid(sLine, iSubCount, 1) = &quot; &quot; Or iSubCount = Len(sLine)) Then
        &#39;&#39;the Length array stores the length of each column (needs to be ReDim&#39;ed with each new column)
        ReDim Preserve Length(iCount)
        Length(iCount) = iSubCount - iLastCount
        iLastCount = iSubCount
        iCount = iCount + 1
    End If
    iSubCount = iSubCount + 1
    Loop

    &#39;&#39;open the file to extract the block based on the column length stored in the Length-Array
    Open sFile For Input Access Read As #1
    iCount = 1
    iSubCount = 1

    &#39;&#39;loop until the end of the block is reached
    Do Until iCount &gt; iEnd
    Line Input #1, sLine
    iLastCount = 1
    If (iCount &gt;= iStart) Then
        For i = 0 To UBound(Length)
            sValue = Trim(Mid(sLine, iLastCount, Length(i)))
            &#39;&#39;prevent application errors with adding of &quot;&#39;&quot; in front of special characters
            If (Left(sValue, 1) = &quot;=&quot; Or Left(sValue, 1) = &quot;-&quot; Or Left(sValue, 1) = &quot;+&quot;) Then
                sValue = &quot;&#39;&quot; &amp; sValue
            End If
            &#39;&#39;insert the data to the current Excel sheet
            Cells(iSubCount, i + 1).Value = sValue
            iLastCount = iLastCount + Length(i)
        Next i
        iSubCount = iSubCount + 1
    End If
    iCount = iCount + 1
    Loop
    &#39;&#39;close the file
    Close #1

End Sub
</code></pre>

    </div>
    <ul class="tag_box inline">
      <li class="icon"><i class="glyphicon glyphicon-tags"></i></li>
      <li>
        <a href="/tags#Excel-ref">Excel <span>2</span></a>
      </li>
      <li>
        <a href="/tags#VBA-ref">VBA <span>2</span></a>
      </li>
      <li>
        <a href="/tags#Programming-ref">Programming <span>21</span></a>
      </li>
    </ul>
    <hr>
    <ul class="pagination">
        <li class="prev"><a href="/posts/2006/12/excel-to-csv-with-python" title="Excel to CSV with Python">&larr; Previous</a></li>

        <li><a href="/archive">Archive</a></li>

        <li class="next"><a href="/posts/2007/06/ms-access-and-not-updatable-recordsets" title="MS Access and not updatable Recordsets">Next &rarr;</a></li>
    </ul>
    <hr>
    <div id="disqus_thread"></div>
<script>
    var disqus_developer = 1;
    var disqus_shortname = 'metaodi'; // required: replace example with your forum shortname
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">blog comments powered by <span class="logo-disqus">Disqus</span></a>

  </div>
</div>


      </div>

      <hr>
      <div class="footer">
        <p>&copy; Stefan Oderbolz (&quot;Odi&quot;) 2019
          with <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    
    <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-47578431-1']);
  _gaq.push(['_trackPageview']);
  

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

</script>


    
  </body>
</html>
