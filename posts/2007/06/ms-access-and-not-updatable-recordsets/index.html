<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Rosarivo' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <title>MS Access and not updatable Recordsets</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stefan Oderbolz (&quot;Odi&quot;)">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- load static files from bower -->
    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="/bower_components/jquery/jquery.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Le styles -->
<link href='/assets/stylesheets/style-6f857850c832817175fdbb4d71c6ee0d.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-afb0925bfa2d994f17dab93e13fbf999.css' type='text/css' rel='stylesheet' media='all'>    
    <!-- Le scripts -->

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

  -->
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">metaodi</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            
              <li><a href="/tags">Tags</a></li>
            
            
              <li><a href="/archive">Archive</a></li>
            
            
              <li><a href="/about">About me</a></li>
            
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
    </nav>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>MS Access and not updatable Recordsets </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>30.06.2007</strong>
    </div>
    <div class="content">
      <p>The whole thing is just plain stupid: Someone in the department I work
in has created an MS Access Database to track our customers. Above this
application are some forms to insert the data. Now we already have much
of the data in various excel sheets etc. So my task was to write a
function (or method or sub or whatever you call it in your world) to get
some values from an excel sheet and insert it to a form, just like a
user would do it. Like that the user has the possibility to check and
change the data before it gets saved in the database. Now if you bind
the form elements to parts of a query, Access gets your data as a so
called snapshot via MS Jet (your communication channel to the DB).
Snapshot data is not updateable, so if you try to assign your own values
to form elements an error message pops up and that’s it.</p>

<p>My first solution was to ignore that fact and simply update my data
directly to the database. But then all nice features like the “undo”
option (to reset a record) or the possibility to check values before
they get inserted are lost. The solution I came up is simple, but you
need to check your status very exact to keep a usable form.</p>

<p>I have a form with my data, I have a save button, I have an exit button
and I have an update button. There is a special button to start the
gathering of data from the excel sheet. Now If you want to change the
value of a textbox on the form you need to cut the textbox off the data
(<code>ControlSource = &quot;&quot;</code>), then you can freely change the value.</p>

<p>Now you can’t simply update the current record, because the textbox is
no longer in the recordset. This means that you have to update the value
directly in the database when the save button is pressed. Then reattach
the ControlSource and Requery and Repaint your form.</p>

<p>When you want to Undo your changed, just don’t save your values in the
DB and reassign the ControlSource and Refresh the form, the old value
will appear.</p>

    </div>
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
      <li>
        <a href="/categories#Tech-ref">Tech <span>11</span></a>
      </li>
    </ul>
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      <li>
        <a href="/tags#MS Access-ref">MS Access <span>2</span></a>
      </li>
      <li>
        <a href="/tags#Programming-ref">Programming <span>11</span></a>
      </li>
    </ul>
    <hr>
    <ul class="pagination">
        <li class="prev"><a href="/posts/2007/05/convert-fixed-length-column-to-excel" title="Convert fixed length column to Excel">&larr; Previous</a></li>

        <li><a href="/archive">Archive</a></li>

        <li class="next"><a href="/posts/2007/08/ms-access-let-lines-in-reports-grow-with-its-content" title="MS Access: Let lines in Reports grow with it's content">Next &rarr;</a></li>
    </ul>
    <hr>
    
  </div>
</div>


      </div>

      <hr>
      <div class="footer">
        <p>&copy; Stefan Oderbolz (&quot;Odi&quot;) 2014
          with <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    
    
  </body>
</html>
