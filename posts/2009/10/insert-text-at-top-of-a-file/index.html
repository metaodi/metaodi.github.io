<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Rosarivo' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <title>Insert text at top of a file</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stefan Oderbolz (&quot;Odi&quot;)">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- load static files from bower -->
    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="/bower_components/jquery/jquery.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Le styles -->
<link href='/assets/stylesheets/style-6f857850c832817175fdbb4d71c6ee0d.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-afb0925bfa2d994f17dab93e13fbf999.css' type='text/css' rel='stylesheet' media='all'>    
    <!-- Le scripts -->

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

  -->
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">metaodi</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            
              <li><a href="/tags">Tags</a></li>
            
            
              <li><a href="/archive">Archive</a></li>
            
            
              <li><a href="/about">About me</a></li>
            
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
    </nav>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>Insert text at top of a file </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>23.10.2009</strong>
    </div>
    <div class="content">
      <p>If you want to insert text at the end of a file (“append”) you can
simply use:</p>

<pre><code> $ echo &quot;test&quot; &gt;&gt; my_file.txt
</code></pre>

<p>which then adds “test” on a new line at the end of the “my_file.txt”.
In my case I had to insert text at top of a file. If you start to google
for that you discover quite fancy solution like using vi or some sed
magic.</p>

<p>For me this was all too much. I have a file with quite static text in
it. At the end of a shell script I want to insert the content of this
file at the beginning of a logfile created by the script.</p>

<p>When using files it’s getting easier:</p>

<pre><code> $ cat my_static_file.txt logfile.txt &gt; temp_logfile.txt 
 $ mv temp_logfile.txt logfile.txt
</code></pre>

<p>But my script can run parallel and therefore this approach is very
dangerous. I was looking for a quick solution and came up with this:</p>

<pre><code> $ cat my_static_file.txt logfile.txt &gt; $$ &amp;&amp; mv $$ logfile.txt
</code></pre>

<p>This has the advantage of being on a single line and using “\$\$” as
filename. \$\$ is the process ID (PID) of the current running script,
and therefore cannot exist twice at the same time.</p>

<p>Because of the usage of &amp;&amp; and calling everything on one line is, that
the following command is only executed when the predecessor command
finished successfully. Otherwise the whole command quits. In my case
this means the logfile will be kept and not moved.</p>

    </div>
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
    </ul>
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      <li>
        <a href="/tags#Linux-ref">Linux <span>6</span></a>
      </li>
    </ul>
    <hr>
    <ul class="pagination">
        <li class="prev"><a href="/posts/2009/10/delete-all-symlink-of-a-directory" title="Delete all symlink of a directory">&larr; Previous</a></li>

        <li><a href="/archive">Archive</a></li>

        <li class="next"><a href="/posts/2009/10/postfinance-sms-service" title="PostFinance SMS Service">Next &rarr;</a></li>
    </ul>
    <hr>
    
  </div>
</div>


      </div>

      <hr>
      <div class="footer">
        <p>&copy; Stefan Oderbolz (&quot;Odi&quot;) 2014
          with <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    
    
  </body>
</html>
