<!DOCTYPE html>
<html lang="en">
  <head>
    <link href='http://fonts.googleapis.com/css?family=Rosarivo' rel='stylesheet' type='text/css'>
    <link href='http://fonts.googleapis.com/css?family=Merriweather:400,700,400italic,700italic' rel='stylesheet' type='text/css'>
    <meta charset="utf-8">
    <title>Using utPLSQL with multiple schemas</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="author" content="Stefan Oderbolz (&quot;Odi&quot;)">

    <!-- Le HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
      <script src="http://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- load static files from bower -->
    <link href="/bower_components/bootstrap/dist/css/bootstrap.min.css" rel="stylesheet" type="text/css" media="all">
    <script src="/bower_components/jquery/jquery.js"></script>
    <script src="/bower_components/bootstrap/dist/js/bootstrap.min.js"></script>

    <!-- Le styles -->
<link href='/assets/stylesheets/style-19503cb7a292d7f3dede6225b80f1d8c.css' type='text/css' rel='stylesheet' media='all'>
<link href='/assets/stylesheets/google_prettify/sons-of-obsidian-afb0925bfa2d994f17dab93e13fbf999.css' type='text/css' rel='stylesheet' media='all'>    
    <!-- Le scripts -->

    <!-- RSS -->
    <link rel="alternate" type="application/rss+xml" title="RSS" href="/rss.xml" />

    <!-- Le fav and touch icons -->
  <!-- Update these with your own images
    <link rel="shortcut icon" href="images/favicon.ico">
    <link rel="apple-touch-icon" href="images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="images/apple-touch-icon-114x114.png">

  -->
  </head>

  <body>
    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
      <div class="container">
      <!-- Brand and toggle get grouped for better mobile display -->
      <div class="navbar-header">
        <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        <a class="navbar-brand" href="/">metaodi</a>
      </div>

      <!-- Collect the nav links, forms, and other content for toggling -->
      <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
        <ul class="nav navbar-nav">
            
              <li><a href="/tags">Tags</a></li>
            
            
              <li><a href="/archive">Archive</a></li>
            
            
              <li><a href="/about">About me</a></li>
            
        </ul>
      </div><!-- /.navbar-collapse -->
    </div>
    </nav>

    <div class="container">

      <div class="content">
        
<div class="page-header">
  <h1>Using utPLSQL with multiple schemas </h1>
</div>

<div class="row-fluid post-full">
  <div class="span12">
    <div class="date">
      <span>12.07.2010</strong>
    </div>
    <div class="content">
      <p>I really like unit testing, and nowadays there is an helping framework
for almost every environment and/or programming language. For PL/SQL
this is <a href="http://utplsql.sourceforge.net/">utPLSQL</a>, which consists of a
bunch of packages that you need to put on your database and then you
should be good to test your could. You <em>should</em>.</p>

<p>I just spent some hours debugging my test code, so I want to share this
with you, maybe I can save someone out there some time.</p>

<h3 id="toc_0">My setting</h3>

<ul>
<li>  <strong>Schema A:</strong> utPLSQL package</li>
<li>  <strong>Schema B:</strong> package XY (code to test), package UT_XY (test code)</li>
</ul>

<p>I have two schemas A and B. In schema A utPLSQL is installed, and in B
is the code to test. It is recommended to have your code to test and
your test code in the same schema.</p>

<p>The following script is used to run the tests:</p>

<pre><code> begin
   for c in (select object_name,owner
               from all_objects
              where object_name like &#39;UT\_%&#39; escape &#39;\&#39;
                and object_type =&#39;PACKAGE&#39;)
   loop
     begin
     utPLSQL.test(
       package_in =&gt; substr(c.object_name,4),
       prefix_in =&gt; &#39;UT_&#39;,
       owner_in =&gt; c.owner
     );
   exception
     -- in case of a faulty unittest continue with the others.
     when others then
       null;
   end;
   end loop;
 end;
 /
</code></pre>

<p>But I kept getting the error:</p>

<pre><code> Program named &quot;XY&quot; does not exist.
</code></pre>

<p>So I thought that somehow the schema A does not “see” the packages in
the schema B and created public synonyms. Unfortunately this didn’t
help. Then I tried to move the “UT_” package to schema A, which worked,
but now I got an error that the code to test and the test code are in
different schemas.</p>

<p>There must be something obvious I’m missing!</p>

<p>And there it was: A had not “execute” grant on the packages in B.</p>

<pre><code>  grant execute on b.xy to A;
</code></pre>

<p>Now everything just worked fine.</p>

    </div>
    <ul class="tag_box inline">
      <li><i class="icon-folder-open"></i></li>
    </ul>
    <ul class="tag_box inline">
      <li><i class="icon-tags"></i></li>
      <li>
        <a href="/tags#utPLSQL, Oracle, Unit Testing, PL/SQL-ref">utPLSQL, Oracle, Unit Testing, PL/SQL <span>1</span></a>
      </li>
    </ul>
    <hr>
    <ul class="pagination">
        <li class="prev"><a href="/posts/2010/05/erroneous-copyfrom-method-in-jcifs-vfs" title="Erroneous copyFrom() method in JCIFS/VFS">&larr; Previous</a></li>

        <li><a href="/archive">Archive</a></li>

        <li class="next"><a href="/posts/2010/08/neuer-tweet-button-in-der-sidebar" title="Neuer Tweet-Button in der Sidebar">Next &rarr;</a></li>
    </ul>
    <hr>
    
  </div>
</div>


      </div>

      <hr>
      <div class="footer">
        <p>&copy; Stefan Oderbolz (&quot;Odi&quot;) 2014
          with <a href="http://ruhoh.com" target="_blank" title="The Definitive Technical Blogging Framework">ruhoh</a>
          and <a href="http://getbootstrap.com/" target="_blank">Bootstrap</a>
        </p>
      </div>

    </div> <!-- /container -->

    <!-- Google Prettify -->
<script src="http://cdnjs.cloudflare.com/ajax/libs/prettify/188.0.0/prettify.js"></script>
<script>
  var pres = document.getElementsByTagName("pre");
  for (var i=0; i < pres.length; ++i) {
    pres[i].className = "prettyprint linenums";
  }
  prettyPrint();
</script>
<!-- end Google Prettify -->
    
    
  </body>
</html>
